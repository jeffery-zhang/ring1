# ring1-v0.3.0 实施计划

- 设计文档: `memory/designs/ring1-v0.3.0.md`
- 创建时间: 02-25-13-48-04
- 当前状态: 未开始开发(仅完成规划)

## 模块 A: 需求确认与边界冻结

- [x] A1. 默认 `--agents` 扩展为 `claude,codex,opencode`
- [x] A2. 确认缺少 `--agents` 时: TTY 交互默认不选，空提交报错；非 TTY 直接报错
- [x] A3. 确认缺少 `--mode` 时直接使用默认 `link`，不进入交互

## 模块 B: Agent 元数据解耦

- [ ] B1. 新建 `src/agent-definitions.ts` 并迁移 `AGENT_DEFINITIONS`
- [ ] B2. 调整 `src/agents.ts` 引用新元数据文件
- [ ] B3. 调整 `src/paths.ts` 引用新元数据文件并保持类型安全

## 模块 C: 新增 opencode 路径支持

- [ ] C1. 扩展 Agent 类型与支持列表为 `claude/codex/opencode`
- [ ] C2. 增加 opencode 目标路径片段 `.config/opencode/AGENTS.md`
- [ ] C3. 验证 Unix-like 与 Windows 路径拼接结果正确

## 模块 D: 交互模块实现

- [ ] D1. 引入交互库并封装 `src/prompts.ts`
- [ ] D2. 实现 agents 多选交互(空格勾选、回车提交)
- [ ] D3. 实现 agents 默认不选与“空提交报错”逻辑
- [ ] D4. 实现非 TTY 缺少 `--agents` 直接报错

## 模块 E: CLI 编排接入

- [ ] E1. 在 `sync` 命令接入“参数优先，缺参交互”流程
- [ ] E2. 调整 `--mode` 缺省策略为默认 `link`(不触发交互)
- [ ] E3. 保持原有参数校验、错误输出与退出码语义
- [ ] E4. 验证三目标执行汇总与 Windows 自动降级逻辑

## 模块 F: 验证与文档收尾

- [ ] F1. 验证无参数启动的交互流程(agents + mode)
- [ ] F2. 验证缺少 `--agents` 且未选择任何项时返回错误
- [ ] F3. 验证缺少 `--mode` 时默认按 `link` 执行
- [ ] F4. 验证带参数启动时不进入交互流程
- [ ] F5. 验证 opencode 路径写入与备份行为
- [ ] F6. 更新 README 中支持列表、路径说明与示例
- [ ] F7. 同步更新实施计划勾选状态并标记完成
- [ ] F8. 若验证出现问题，记录到 `memory/validations`
